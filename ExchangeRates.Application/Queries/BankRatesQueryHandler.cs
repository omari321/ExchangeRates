using ExchangeRates.Domain.Entities;
using ExchangeRates.Infrastructure.Repositories.Abstractions;
using ExchangeRates.Shared;
using ExchangeRates.Shared.Extensions;
using MediatR;
using Microsoft.EntityFrameworkCore;

namespace ExchangeRates.Application.Queries;

public class BankCurrencyInformationDto
{
    public string BankName { get; }
    public string? LogoUrl { get; }
    public decimal BuyRate { get; }
    public decimal SellRate { get; }

    public BankCurrencyInformationDto(string bankName, decimal buyRate, decimal sellRate)
    {
        BankName = bankName;
        BuyRate = buyRate;
        SellRate = sellRate;
        LogoUrl = MapBankNameToLogoUrl(bankName);
    }

    private static string? MapBankNameToLogoUrl(string bankName)
    {
        var map = new Dictionary<string, string>
        {
            ["Pasha Bank"] = "https://play-lh.googleusercontent.com/iWq6vTGGswXqhPB4sOzGfcEF1NfCYi6X3IoZcJ_zjBNpKJjflmpxTgDPCK8yTFca-7Cm",
            ["Procredit Bank"] = "data:image/png;base64,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",
            ["Tbc Bank"] = "https://play-lh.googleusercontent.com/jDZey_jeFRaVFKRBgaS3mWtrEP8S8DPRl-B4YijVGf-OxcN6dAB8j7AyDddlvAZN4nOM=w240-h480-rw",
            ["Bank Of Georgia"] = "https://play-lh.googleusercontent.com/GXkEoG4IWeByivskzwUU7v2-aTP3ioi941rD4_p8gkuQhfMo_Y0Ra_soYz0Ed0TV4wDv",
            ["Ish Bank"] = "https://www.isbank.co.uk/StaticFiles/London/public/dist/img/favicon/isbank-og-image.jpg",
            ["Silk Bank"] = "https://seeklogo.com/images/S/silk-bank-logo-255CE2AA55-seeklogo.com.png",
            ["Halyk Bank"] = "https://w1.pngwing.com/pngs/491/897/png-transparent-line-leader-halyk-bank-finance-cult-leader-green-yellow-text-circle-thumbnail.png",
            ["Credo Bank"] = "data:image/jpeg;base64,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",
            ["Liberty Bank"] = "https://libertybank.ge/m/i/logo-fb-en.png",
        };

         map.TryGetValue(bankName, out var url);
         
         return url;
    }
}


public record BankRatesDto(string CurrencyName, decimal OfficialRate, decimal Diff, List<BankCurrencyInformationDto>? BankCurrencyInformationDto);
public record BankRatesQuery(AvailableCurrencies Currencies, DateTime? Date) : IRequest<BankRatesDto>;

public class BankRatesQueryHandler : IRequestHandler<BankRatesQuery, BankRatesDto>
{
    private readonly IRepository<BankCurrenciesExchangeRatesEntity> _repository;

    public BankRatesQueryHandler(IRepository<BankCurrenciesExchangeRatesEntity> repository)
    {
        _repository = repository;
    }

    public async Task<BankRatesDto> Handle(BankRatesQuery request, CancellationToken cancellationToken)
    {
        var date = request.Date?.ToUniversalTime().Date ?? DateTime.Now.ToUniversalTime().Date;
        var data = await _repository
            .Query(x => x.CreateDate.Date == date)
            .FirstAsync(cancellationToken: cancellationToken);

        var currencyInfo = data.CurrencyRatesInformation
            .First(rate => rate.CurrencyName == request.Currencies.GetCurrencyNameFromEnum());

        var bankCurrencyInfoDto = currencyInfo.ExchangeRates
            .Select(rate => new BankCurrencyInformationDto(rate!.BankName,rate.BuyRate, rate.SellRate))
            .OrderByDescending(x => x.SellRate)
            .ToList();
        
        return new BankRatesDto(currencyInfo.CurrencyName, currencyInfo.OfficialRate, currencyInfo.Diff, bankCurrencyInfoDto);
    }
}